---
import { getCollection } from 'astro:content';
import EpisodeCard from './EpisodeCard.astro';

const allEpisodes = await getCollection('episodes', ({ data }) => {
  return !data.draft;
});

// Sort by episode number, newest first
const sortedEpisodes = allEpisodes.sort((a, b) =>
  b.data.episodeNumber - a.data.episodeNumber
);
---

<div class="episode-list grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
  {sortedEpisodes.map((episode) => (
    <EpisodeCard
      slug={episode.slug}
      title={episode.data.title}
      description={episode.data.description}
      pubDate={episode.data.pubDate}
      episodeNumber={episode.data.episodeNumber}
      tags={episode.data.tags}
      youtubeId={episode.data.youtubeId}
    />
  ))}
</div>

{sortedEpisodes.length === 0 && (
  <div class="text-center py-12">
    <p class="text-terminal-greenDim text-lg terminal-prompt">
      No episodes found. Check back soon!
    </p>
  </div>
)}
